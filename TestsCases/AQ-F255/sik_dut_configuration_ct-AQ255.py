wait("aq_status_green.png", 10)
wait("aq_menustruct_all.png", 10)
click("aq_menustruct_measurement.png")
wait(2)
click(Pattern("aq_menutabs_measurement_1st_half.png").similar(0.60).targetOffset(-376,16))
wait(2)
click(Pattern("aq_menutabs_trafos_ct1_vt1.png").targetOffset(-83,7))
wait(2)
click(Pattern("1692192811666.png").similar(0.74).targetOffset(129,10))
wait(2)
click(Pattern("1692194837073.png").targetOffset(-41,20))
wait(2)
click(Pattern("1692194573742.png").similar(0.84).targetOffset(639,-4))
type("a", Key.CTRL)
type("339"+Key.ENTER)
wait(2)
click(Pattern("aq_param_phase_ct_sec.png").targetOffset(597,-9))
type("a", Key.CTRL)
type("0.5"+Key.ENTER)
click(Pattern("aq_menustrip.png").targetOffset(-121,-1))
click(Pattern("aq_menustrip_commands_connected.png").targetOffset(-80,-64))
click(Pattern("aq_dialog_write_changes.png").similar(0.85).targetOffset(-230,302))
wait(5) # Give some time for the reset pending button to appear
if exists(Pattern("aq_protection_reset_pending.png").similar(0.85)):
    click(Pattern("aq_protection_reset_pending.png").similar(0.85).targetOffset(150,1))
    Do.popup("Waiting 10 seconds for the DUT to reboot", 10)